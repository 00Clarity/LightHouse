/* THE LIGHTHOUSE KEEPER - Animation System */

/* ===== LIGHTHOUSE BEAM ===== */

#lighthouse-beam {
  position: fixed;
  top: 0;
  left: 50%;
  width: 200vw;
  height: 200vh;
  transform-origin: 50% 0;
  pointer-events: none;
  z-index: var(--z-beam);
  background: conic-gradient(
    from 0deg at 50% 0%,
    transparent 0deg,
    rgba(240, 200, 96, 0.06) 1deg,
    rgba(240, 200, 96, 0.10) 3deg,
    rgba(240, 200, 96, 0.06) 5deg,
    transparent 8deg,
    transparent 360deg
  );
  animation: beam-sweep 12s linear infinite;
}

@keyframes beam-sweep {
  from { transform: translateX(-50%) rotate(0deg); }
  to { transform: translateX(-50%) rotate(360deg); }
}

#lighthouse-beam.dim {
  opacity: 0.4;
}

#lighthouse-beam.bright {
  opacity: 1;
  background: conic-gradient(
    from 0deg at 50% 0%,
    transparent 0deg,
    rgba(240, 200, 96, 0.12) 1deg,
    rgba(240, 200, 96, 0.18) 3deg,
    rgba(240, 200, 96, 0.12) 5deg,
    transparent 8deg,
    transparent 360deg
  );
}

#lighthouse-beam.flare {
  animation: beam-flare 0.5s ease-out;
}

@keyframes beam-flare {
  0% { opacity: 1; }
  50% { opacity: 1.5; filter: brightness(1.5); }
  100% { opacity: 1; }
}

/* ===== OCEAN LAYER ===== */

#ocean-layer {
  position: fixed;
  inset: 0;
  z-index: var(--z-base);
  background: linear-gradient(
    180deg,
    #0a1419 0%,
    #0d1820 40%,
    #12202a 70%,
    #1a2d3a 100%
  );
}

#ocean-layer::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent 0px,
    rgba(20, 60, 80, 0.03) 1px,
    transparent 3px
  );
  animation: wave-drift 15s ease-in-out infinite;
}

#ocean-layer::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(
    ellipse at 50% 100%,
    rgba(30, 80, 100, 0.1) 0%,
    transparent 50%
  );
  animation: wave-glow 8s ease-in-out infinite;
}

@keyframes wave-drift {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(10px); }
}

@keyframes wave-glow {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.8; }
}

/* ===== TENSION VIGNETTE ===== */

#tension-vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: var(--z-vignette);
  box-shadow: inset 0 0 100px transparent;
  transition: box-shadow 2s ease;
}

#tension-vignette.tension-low {
  box-shadow: inset 0 0 100px rgba(20, 40, 60, 0.2);
}

#tension-vignette.tension-medium {
  box-shadow: inset 0 0 120px rgba(60, 40, 30, 0.3);
}

#tension-vignette.tension-high {
  box-shadow: inset 0 0 150px rgba(80, 30, 20, 0.4);
}

#tension-vignette.tension-critical {
  box-shadow: inset 0 0 180px rgba(100, 20, 10, 0.5);
  animation: vignette-pulse 2s ease-in-out infinite;
}

@keyframes vignette-pulse {
  0%, 100% { box-shadow: inset 0 0 180px rgba(100, 20, 10, 0.5); }
  50% { box-shadow: inset 0 0 200px rgba(120, 20, 10, 0.6); }
}

/* ===== MEMORY OVERLAY ===== */

#memory-overlay {
  position: fixed;
  inset: 0;
  background: rgba(30, 25, 20, 0);
  pointer-events: none;
  z-index: var(--z-modal);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 1s ease;
}

#memory-overlay.active {
  background: rgba(30, 25, 20, 0.92);
  pointer-events: auto;
}

#memory-content {
  max-width: 500px;
  padding: 40px;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 1s ease 0.5s, transform 1s ease 0.5s;
  text-align: center;
}

#memory-overlay.active #memory-content {
  opacity: 1;
  transform: translateY(0);
}

#memory-trigger {
  font-style: italic;
  color: #c08060;
  margin-bottom: 24px;
  font-size: 0.9375rem;
}

#memory-text {
  color: #a09080;
  font-size: 1.0625rem;
  line-height: 2;
  font-family: var(--font-display);
}

#memory-dismiss {
  margin-top: 32px;
  padding: 12px 24px;
  background: transparent;
  border: 1px solid #605040;
  color: #a09080;
  font-family: var(--font-system);
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  cursor: pointer;
  transition: all var(--transition-fast);
}

#memory-dismiss:hover {
  background: rgba(96, 80, 64, 0.2);
  border-color: #a09080;
}

/* ===== RAIN EFFECT ===== */

#rain-container {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 5;
  opacity: 0;
  transition: opacity 2s;
  overflow: hidden;
}

#rain-container.active {
  opacity: 1;
}

.raindrop {
  position: absolute;
  top: -20px;
  width: 1px;
  height: 20px;
  background: linear-gradient(
    to bottom,
    transparent,
    rgba(150, 180, 200, 0.5)
  );
  animation: rain-fall linear infinite;
}

@keyframes rain-fall {
  to {
    transform: translateY(100vh);
  }
}

/* ===== FOG EFFECT (Week 5) ===== */

#fog-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 4;
  opacity: 0;
  transition: opacity 3s;
  background:
    radial-gradient(ellipse at 20% 80%, rgba(200, 210, 220, 0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 60%, rgba(200, 210, 220, 0.1) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 90%, rgba(200, 210, 220, 0.12) 0%, transparent 45%);
}

#fog-overlay.active {
  opacity: 1;
  animation: fog-drift 20s ease-in-out infinite;
}

@keyframes fog-drift {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(20px); }
}

/* ===== INK EFFECTS ===== */

@keyframes ink-bleed {
  0% {
    text-shadow: 0 0 0 currentColor;
    filter: blur(0);
  }
  30% {
    text-shadow:
      1px 0 0 currentColor,
      -1px 0 0 currentColor,
      0 1px 0 currentColor;
    filter: blur(0.5px);
  }
  100% {
    text-shadow: 0 0 0 currentColor;
    filter: blur(0);
  }
}

.entry-locked {
  animation: ink-bleed 0.5s ease-out;
}

@keyframes ink-splatter {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  50% {
    opacity: 1;
    transform: scale(1.1);
  }
  100% {
    opacity: 0.8;
    transform: scale(1);
  }
}

.ink-splatter {
  animation: ink-splatter 0.3s ease-out forwards;
}

/* ===== WEEK TRANSITION ===== */

#week-transition {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  transition: opacity 1s ease;
}

#week-transition.active {
  opacity: 1;
  pointer-events: auto;
}

.transition-text {
  font-family: var(--font-display);
  font-size: 2rem;
  color: var(--land-light);
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 1s ease, transform 1s ease;
}

#week-transition.active .transition-text {
  opacity: 1;
  transform: translateY(0);
  transition-delay: 0.5s;
}

.transition-subtext {
  font-family: var(--font-system);
  font-size: 0.875rem;
  color: var(--sea-foam);
  margin-top: 16px;
  opacity: 0;
  transition: opacity 1s ease;
}

#week-transition.active .transition-subtext {
  opacity: 1;
  transition-delay: 1s;
}

/* ===== ENTRY SUBMISSION ANIMATION ===== */

@keyframes entry-lock {
  0% {
    transform: scale(1);
  }
  10% {
    transform: scale(0.98);
  }
  30% {
    transform: scale(1.02);
  }
  100% {
    transform: scale(1);
  }
}

.entry-locking {
  animation: entry-lock 0.5s ease-out;
}

/* Screen dim during entry lock */
.screen-dim {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0);
  pointer-events: none;
  z-index: 99;
  transition: background 0.3s ease;
}

.screen-dim.active {
  background: rgba(0, 0, 0, 0.4);
}

/* ===== PORTRAIT ANIMATIONS ===== */

@keyframes portrait-speak {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

.portrait-speaking {
  animation: portrait-speak 0.5s ease-in-out infinite;
}

@keyframes portrait-reaction {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.portrait-react {
  animation: portrait-reaction 0.3s ease-out;
}

/* ===== FRAGMENT ANIMATIONS ===== */

@keyframes fragment-appear {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fragment-new {
  animation: fragment-appear 0.3s ease-out;
}

@keyframes fragment-place {
  0% {
    transform: scale(1.1);
    opacity: 0.8;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.fragment-placed {
  animation: fragment-place 0.2s ease-out;
}

/* ===== MODAL ANIMATIONS ===== */

@keyframes modal-enter {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes modal-exit {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
}

.modal-entering {
  animation: modal-enter 0.3s ease-out forwards;
}

.modal-exiting {
  animation: modal-exit 0.2s ease-in forwards;
}

/* ===== LOADING/INTRO ANIMATIONS ===== */

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in {
  animation: fade-in 1s ease-out forwards;
}

.slide-up {
  animation: slide-up 0.8s ease-out forwards;
}

.delay-1 { animation-delay: 0.2s; }
.delay-2 { animation-delay: 0.4s; }
.delay-3 { animation-delay: 0.6s; }
.delay-4 { animation-delay: 0.8s; }
.delay-5 { animation-delay: 1.0s; }

/* ===== CONSEQUENCE ROLL-IN ===== */

@keyframes consequence-appear {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.consequence-item {
  animation: consequence-appear 0.4s ease-out forwards;
}

.consequence-item:nth-child(1) { animation-delay: 0.1s; }
.consequence-item:nth-child(2) { animation-delay: 0.2s; }
.consequence-item:nth-child(3) { animation-delay: 0.3s; }
.consequence-item:nth-child(4) { animation-delay: 0.4s; }
.consequence-item:nth-child(5) { animation-delay: 0.5s; }

/* ===== INTRO SEQUENCE ===== */

#intro-sequence {
  position: fixed;
  inset: 0;
  background: #050a0d;
  z-index: 2000;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

#intro-sequence.active {
  display: flex;
}

/* Intro lighthouse silhouette */
.intro-lighthouse {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 300px;
  opacity: 0;
}

.intro-lighthouse.visible {
  animation: lighthouse-rise 2s ease-out forwards;
}

@keyframes lighthouse-rise {
  0% { opacity: 0; transform: translateX(-50%) translateY(100px); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.lighthouse-tower {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 40px;
  height: 200px;
  background: linear-gradient(to top, #1a2d3a, #2d4a5a);
  border-radius: 5px 5px 0 0;
}

.lighthouse-lamp {
  position: absolute;
  bottom: 200px;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 50px;
  background: #2d4a5a;
  border-radius: 5px;
}

.lighthouse-light {
  position: absolute;
  bottom: 220px;
  left: 50%;
  transform: translateX(-50%);
  width: 20px;
  height: 20px;
  background: #f0c860;
  border-radius: 50%;
  box-shadow: 0 0 40px 20px rgba(240, 200, 96, 0.4),
              0 0 80px 40px rgba(240, 200, 96, 0.2);
  opacity: 0;
}

.lighthouse-light.glow {
  animation: light-pulse 2s ease-in-out infinite;
}

@keyframes light-pulse {
  0%, 100% { opacity: 0.6; box-shadow: 0 0 40px 20px rgba(240, 200, 96, 0.4), 0 0 80px 40px rgba(240, 200, 96, 0.2); }
  50% { opacity: 1; box-shadow: 0 0 60px 30px rgba(240, 200, 96, 0.6), 0 0 120px 60px rgba(240, 200, 96, 0.3); }
}

.lighthouse-base {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 40px;
  background: #1a2d3a;
  border-radius: 5px 5px 0 0;
}

/* Intro waves */
.intro-waves {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 80px;
  background: linear-gradient(to top, #0a141a, transparent);
  overflow: hidden;
}

.wave {
  position: absolute;
  bottom: 0;
  left: -100%;
  width: 300%;
  height: 30px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 120'%3E%3Cpath fill='%23143040' d='M0,60 C150,120 350,0 600,60 C850,120 1050,0 1200,60 L1200,120 L0,120 Z'/%3E%3C/svg%3E") repeat-x;
  background-size: 600px 30px;
  animation: wave-flow 8s linear infinite;
}

.wave:nth-child(2) {
  bottom: 10px;
  opacity: 0.5;
  animation-duration: 12s;
  animation-direction: reverse;
}

@keyframes wave-flow {
  from { transform: translateX(0); }
  to { transform: translateX(600px); }
}

/* Intro text container */
.intro-text-container {
  position: relative;
  z-index: 10;
  max-width: 700px;
  padding: 2rem;
  text-align: center;
}

.intro-text {
  font-family: var(--font-display);
  font-size: 1.5rem;
  line-height: 2;
  color: var(--land-light);
  opacity: 0;
  margin-bottom: 2rem;
}

.intro-text.visible {
  animation: text-fade-in 1.5s ease-out forwards;
}

.intro-text.fade-out {
  animation: text-fade-out 0.8s ease-in forwards;
}

@keyframes text-fade-in {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes text-fade-out {
  0% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-20px); }
}

.intro-quote {
  font-family: var(--font-display);
  font-style: italic;
  font-size: 1.125rem;
  color: var(--sea-foam);
  opacity: 0;
  line-height: 1.8;
}

.intro-quote.visible {
  animation: text-fade-in 1.5s ease-out forwards;
}

/* Intro beam effect */
.intro-beam {
  position: absolute;
  top: 0;
  left: 50%;
  width: 300vw;
  height: 300vh;
  transform-origin: 50% calc(100% - 220px);
  pointer-events: none;
  background: conic-gradient(
    from 0deg at 50% calc(100% - 220px),
    transparent 0deg,
    rgba(240, 200, 96, 0.08) 2deg,
    rgba(240, 200, 96, 0.15) 5deg,
    rgba(240, 200, 96, 0.08) 8deg,
    transparent 12deg,
    transparent 360deg
  );
  opacity: 0;
}

.intro-beam.active {
  opacity: 1;
  animation: intro-beam-sweep 6s linear infinite;
}

@keyframes intro-beam-sweep {
  from { transform: translateX(-50%) rotate(-30deg); }
  to { transform: translateX(-50%) rotate(330deg); }
}

/* Skip intro button */
.skip-intro {
  position: absolute;
  bottom: 2rem;
  right: 2rem;
  padding: 0.5rem 1rem;
  background: transparent;
  border: 1px solid rgba(240, 200, 96, 0.3);
  color: var(--light-dim);
  font-family: var(--font-system);
  font-size: 0.875rem;
  cursor: pointer;
  opacity: 0;
  transition: all 0.3s ease;
  z-index: 100;
}

.skip-intro.visible {
  animation: text-fade-in 0.5s ease-out forwards;
  animation-delay: 2s;
}

.skip-intro:hover {
  background: rgba(240, 200, 96, 0.1);
  border-color: var(--light-glow);
  color: var(--land-light);
}

/* Intro overlay fade */
#intro-sequence.fade-out {
  animation: intro-fade-out 1.5s ease-in forwards;
}

@keyframes intro-fade-out {
  0% { opacity: 1; }
  100% { opacity: 0; visibility: hidden; }
}

/* ===== WEEK TRANSITION SEQUENCE ===== */

#week-transition-sequence {
  position: fixed;
  inset: 0;
  background: #050a0d;
  z-index: 1500;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

#week-transition-sequence.active {
  display: flex;
  animation: transition-fade-in 1s ease-out forwards;
}

@keyframes transition-fade-in {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

#week-transition-sequence.fade-out {
  animation: transition-fade-out 1.5s ease-in forwards;
}

@keyframes transition-fade-out {
  0% { opacity: 1; }
  100% { opacity: 0; visibility: hidden; }
}

/* Week number display */
.week-transition-number {
  font-family: var(--font-display);
  font-size: 5rem;
  color: var(--light-glow);
  opacity: 0;
  text-shadow: 0 0 40px rgba(240, 200, 96, 0.4);
  margin-bottom: 1rem;
}

.week-transition-number.visible {
  animation: week-number-appear 1.5s ease-out forwards;
}

@keyframes week-number-appear {
  0% { opacity: 0; transform: scale(0.8); }
  50% { opacity: 1; transform: scale(1.05); }
  100% { opacity: 1; transform: scale(1); }
}

/* Week title */
.week-transition-title {
  font-family: var(--font-display);
  font-size: 2rem;
  color: var(--land-light);
  opacity: 0;
  margin-bottom: 2rem;
  letter-spacing: 0.1em;
}

.week-transition-title.visible {
  animation: text-fade-in 1s ease-out forwards;
}

/* Narrative text container */
.transition-narrative {
  max-width: 600px;
  padding: 0 2rem;
  text-align: center;
}

.transition-narrative-text {
  font-family: var(--font-display);
  font-style: italic;
  font-size: 1.125rem;
  line-height: 1.9;
  color: var(--sea-foam);
  opacity: 0;
  margin-bottom: 1.5rem;
}

.transition-narrative-text.visible {
  animation: narrative-fade-in 1.2s ease-out forwards;
}

@keyframes narrative-fade-in {
  0% { opacity: 0; transform: translateY(15px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Consequence summary */
.transition-consequence {
  font-family: var(--font-system);
  font-size: 0.9rem;
  color: var(--light-dim);
  opacity: 0;
  padding: 1rem 1.5rem;
  background: rgba(26, 45, 58, 0.4);
  border-radius: var(--radius-md);
  border-left: 3px solid var(--light-warning);
  margin-top: 1rem;
  text-align: left;
  max-width: 500px;
}

.transition-consequence.visible {
  animation: narrative-fade-in 1s ease-out forwards;
}

.transition-consequence.positive {
  border-left-color: var(--light-verdant);
}

.transition-consequence.negative {
  border-left-color: var(--light-danger);
}

.transition-consequence.neutral {
  border-left-color: var(--sea-foam);
}

/* Time indicator */
.transition-time {
  position: absolute;
  top: 2rem;
  left: 50%;
  transform: translateX(-50%);
  font-family: var(--font-system);
  font-size: 0.875rem;
  color: var(--light-dim);
  opacity: 0;
  letter-spacing: 0.2em;
  text-transform: uppercase;
}

.transition-time.visible {
  animation: text-fade-in 0.8s ease-out forwards;
}

/* Background effects for transitions */
.transition-background {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* Dawn gradient (Week 2, 3) */
.transition-background.dawn {
  background: linear-gradient(
    to top,
    #0a141a 0%,
    #1a2d3a 30%,
    #2d4a5a 60%,
    #4a6070 80%,
    #f0c86020 100%
  );
}

/* Dusk gradient (Week 4) */
.transition-background.dusk {
  background: linear-gradient(
    to top,
    #0a141a 0%,
    #1a1a2a 30%,
    #3a2a3a 60%,
    #5a3a4a 80%,
    #804050 100%
  );
}

/* Night gradient (Week 5) */
.transition-background.night {
  background: linear-gradient(
    to top,
    #050a0d 0%,
    #0a141a 40%,
    #101a20 70%,
    #152030 100%
  );
}

/* Storm overlay */
.transition-storm {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(180deg, rgba(20, 30, 40, 0.8) 0%, transparent 50%),
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 2px,
      rgba(100, 120, 140, 0.03) 2px,
      rgba(100, 120, 140, 0.03) 4px
    );
  opacity: 0;
  pointer-events: none;
}

.transition-storm.active {
  opacity: 1;
  animation: storm-flicker 0.15s infinite;
}

@keyframes storm-flicker {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

/* Village silhouette */
.transition-village {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 120px;
  opacity: 0;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 120'%3E%3Cpath fill='%23101820' d='M0,120 L0,80 L50,80 L50,60 L70,60 L70,50 L90,50 L90,80 L120,80 L120,70 L140,70 L140,60 L160,40 L180,60 L180,70 L200,70 L200,80 L250,80 L250,70 L270,70 L270,50 L290,30 L310,50 L310,70 L330,70 L330,80 L400,80 L400,60 L420,60 L420,40 L440,20 L460,40 L460,60 L480,60 L480,80 L520,80 L520,70 L540,70 L540,55 L560,55 L560,70 L580,70 L580,80 L650,80 L650,65 L680,65 L680,45 L700,45 L700,65 L730,65 L730,80 L800,80 L800,120 Z'/%3E%3C/svg%3E") repeat-x;
  background-size: 800px 120px;
  background-position: center bottom;
}

.transition-village.visible {
  animation: village-appear 1.5s ease-out forwards;
}

@keyframes village-appear {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 0.6; transform: translateY(0); }
}

/* Tension indicator */
.transition-tension {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 0.75rem;
  opacity: 0;
}

.transition-tension.visible {
  animation: text-fade-in 0.8s ease-out forwards;
  animation-delay: 0.5s;
}

.transition-tension-label {
  font-family: var(--font-system);
  font-size: 0.75rem;
  color: var(--light-dim);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.transition-tension-bar {
  width: 150px;
  height: 4px;
  background: rgba(26, 45, 58, 0.5);
  border-radius: 2px;
  overflow: hidden;
}

.transition-tension-fill {
  height: 100%;
  background: var(--light-warning);
  transition: width 1.5s ease-out;
}

.transition-tension-fill.low {
  background: var(--light-verdant);
}

.transition-tension-fill.medium {
  background: var(--light-warning);
}

.transition-tension-fill.high {
  background: #e07050;
}

.transition-tension-fill.critical {
  background: var(--light-danger);
}

/* Skip button for transitions */
.skip-transition {
  position: absolute;
  bottom: 2rem;
  right: 2rem;
  padding: 0.5rem 1rem;
  background: transparent;
  border: 1px solid rgba(240, 200, 96, 0.3);
  color: var(--light-dim);
  font-family: var(--font-system);
  font-size: 0.875rem;
  cursor: pointer;
  opacity: 0;
  transition: all 0.3s ease;
  z-index: 100;
}

.skip-transition.visible {
  animation: text-fade-in 0.5s ease-out forwards;
  animation-delay: 1s;
}

.skip-transition:hover {
  background: rgba(240, 200, 96, 0.1);
  border-color: var(--light-glow);
  color: var(--land-light);
}

/* ===== WEEK TRANSITION ELEMENTS ===== */

/* Storm overlay element */
.transition-storm-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    linear-gradient(180deg, rgba(20, 30, 40, 0.6) 0%, transparent 40%),
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 3px,
      rgba(100, 120, 140, 0.04) 3px,
      rgba(100, 120, 140, 0.04) 6px
    );
  opacity: 0;
  transition: opacity 1s ease;
  animation: storm-pulse 3s ease-in-out infinite;
}

@keyframes storm-pulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* Village silhouette container */
.transition-silhouette {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 150px;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 20px;
  padding: 0 10%;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 1.5s ease-out, transform 1.5s ease-out;
}

.transition-silhouette.visible {
  opacity: 0.7;
  transform: translateY(0);
}

/* Village houses */
.village-house {
  background: #0a1015;
  position: relative;
}

.village-house.house-1 {
  width: 40px;
  height: 50px;
}

.village-house.house-1::before {
  content: '';
  position: absolute;
  top: -20px;
  left: 0;
  width: 0;
  height: 0;
  border-left: 20px solid transparent;
  border-right: 20px solid transparent;
  border-bottom: 20px solid #0a1015;
}

.village-house.house-2 {
  width: 35px;
  height: 60px;
}

.village-house.house-2::before {
  content: '';
  position: absolute;
  top: -18px;
  left: 0;
  width: 0;
  height: 0;
  border-left: 17.5px solid transparent;
  border-right: 17.5px solid transparent;
  border-bottom: 18px solid #0a1015;
}

.village-house.house-3 {
  width: 45px;
  height: 55px;
}

.village-house.house-3::before {
  content: '';
  position: absolute;
  top: -22px;
  left: 0;
  width: 0;
  height: 0;
  border-left: 22.5px solid transparent;
  border-right: 22.5px solid transparent;
  border-bottom: 22px solid #0a1015;
}

/* Village church - taller with steeple */
.village-church {
  width: 50px;
  height: 80px;
  background: #0a1015;
  position: relative;
}

.village-church::before {
  content: '';
  position: absolute;
  top: -35px;
  left: 10px;
  width: 30px;
  height: 35px;
  background: #0a1015;
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
}

.village-church::after {
  content: '';
  position: absolute;
  top: -45px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 15px;
  background: #0a1015;
}

.village-house.house-4 {
  width: 38px;
  height: 48px;
}

.village-house.house-4::before {
  content: '';
  position: absolute;
  top: -19px;
  left: 0;
  width: 0;
  height: 0;
  border-left: 19px solid transparent;
  border-right: 19px solid transparent;
  border-bottom: 19px solid #0a1015;
}

.village-house.house-5 {
  width: 42px;
  height: 52px;
}

.village-house.house-5::before {
  content: '';
  position: absolute;
  top: -21px;
  left: 0;
  width: 0;
  height: 0;
  border-left: 21px solid transparent;
  border-right: 21px solid transparent;
  border-bottom: 21px solid #0a1015;
}

/* Transition content container */
.transition-content {
  position: relative;
  z-index: 10;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 2rem;
  max-width: 600px;
}

/* Tension container for week transitions */
.transition-tension-container {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 2rem;
  opacity: 0;
  transform: translateY(-10px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

.transition-tension-container.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Week text styling */
.transition-week-text {
  font-family: var(--font-display);
  font-size: 4rem;
  color: var(--light-glow);
  text-shadow: 0 0 40px rgba(240, 200, 96, 0.4);
  margin-bottom: 0.5rem;
  letter-spacing: 0.05em;
}

.transition-subtitle {
  font-family: var(--font-display);
  font-style: italic;
  font-size: 1.5rem;
  color: var(--sea-foam);
  margin-bottom: 2rem;
  letter-spacing: 0.03em;
}

/* Consequence list */
.transition-consequence-list {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  width: 100%;
  max-width: 500px;
}

/* Skip button for week transition */
.transition-skip {
  position: absolute;
  bottom: 2rem;
  right: 2rem;
  padding: 0.5rem 1.25rem;
  background: transparent;
  border: 1px solid rgba(240, 200, 96, 0.3);
  color: var(--light-dim);
  font-family: var(--font-system);
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 100;
}

.transition-skip:hover {
  background: rgba(240, 200, 96, 0.1);
  border-color: var(--light-glow);
  color: var(--land-light);
}

/* Background visibility states */
.transition-background.visible {
  animation: bg-fade-in 1.5s ease-out forwards;
}

@keyframes bg-fade-in {
  0% { opacity: 0; }
  100% { opacity: 1; }
}
