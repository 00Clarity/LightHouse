# THE LIGHTHOUSE KEEPER
## A Game About Memory, Power, and the Violence of Record-Keeping

---

# PART I: VISION

## The Core Thesis

**"The record is never the event. But when the record is all anyone has, the record becomes the truth."**

You are the Lighthouse Keeper of a small coastal village. You tend the light that guides ships safely home. You also keep the log — the official record that travels to the mainland each season.

What you write becomes history. What you omit never happened.

But you are not a neutral observer. You came here five years ago, running from something. A record you made that destroyed a man. Or saved one. You're still not sure which.

Now you document others. And slowly, the village begins to document you.

---

## The Kojima Principles

This game follows the Kojima approach to narrative design:

### 1. The System is Visible But Incomprehensible
The villagers have relationships, histories, secrets. You see fragments — a meaningful glance, a whispered name, a hand that trembles. The full picture is always just out of reach. You make decisions with incomplete information. So does everyone.

### 2. The Personal is Political
Your private wound — the record you made before — is not backstory. It IS the theme. Your guilt about one man becomes the lens through which you see every choice. The intimate becomes universal.

### 3. Sincerity Inside Absurdity
The premise is heightened. A lighthouse keeper who controls truth? Villagers who can't read but somehow know what you wrote? Accept the poetry. Then make it hurt.

### 4. The Player is Complicit
You don't realize what you've done until it's too late. The first entry seems harmless. The fifth entry reveals the pattern. The final entry forces you to see yourself.

### 5. Technology as Spirituality
The lighthouse isn't just a lighthouse. It's a mechanism for illumination — making visible what was in darkness. The log isn't just bureaucracy. It's a ritual that transforms events into permanence. The pen is sacramental.

---

## Emotional Arc

**Week 1:** Orientation. You learn the systems. A simple dispute. The villagers are archetypes.

**Week 2:** Complication. A secret surfaces. The archetypes become people. The past intrudes.

**Week 3:** Investment. Someone trusts you with something fragile. You have the power to protect or expose. The cost of each becomes clear.

**Week 4:** Crisis. Violence — physical or emotional. The village fractures. Your prior entries shaped this moment. You see the chain of consequence.

**Week 5:** Reckoning. Everyone knows the log is going out. They come to you — not to plead, but to be seen. And you must write about yourself. What kind of keeper have you been?

**Ending:** The log goes to the mainland. But you remain. Living with the people you documented. Being documented by the boy who watched everything.

---

# PART II: SYSTEMS

## The Village as Living System

### Population: 47 souls

The village is small enough to know everyone, large enough to have factions. Three major families, one church, one lighthouse, one tavern, a handful of craftsmen.

### The Three Families

**The Shore Family (Marta's line)**
- Original settlers. Four generations deep.
- Control the best fishing waters by tradition.
- Believe the village belongs to those who've always been here.
- Color: Deep green, like sea-weathered wood.

**The Hill Family (Father Simão's parish)**
- Came two generations ago during a famine.
- Trades, crafts, the chapel.
- Positioned themselves as neutral arbiters.
- Color: Warm amber, like candlelight.

**The Newcomers (Tomás and others)**
- Arrived within the last decade.
- Skilled but unintegrated.
- Carry secrets from the mainland.
- Color: Slate gray, like stone.

### Faction Dynamics

```
          SHORE ←—tension—→ NEWCOMER
              \           /
               \         /
                \       /
                 CHURCH
                (mediator)
```

Your entries shift these relationships. Favor the Shore family repeatedly? The Newcomers grow desperate. Appear too neutral? Everyone distrusts you. The Church notices everything and remembers.

---

## The Villagers: Full Profiles

### PRIMARY CAST

#### Old Marta
**Age:** 68 | **Family:** Shore | **Role:** Elder, Widow

**Visible:** The matriarch. Remembers everything. Knows where every body is buried — metaphorically, and perhaps literally. Commands respect through sheer presence.

**Hidden:** Her husband was murdered twenty years ago. She knows who did it. She's chosen silence over justice because justice would destroy what remains of her family.

**Secret:** Péter's father was one of the killers. Péter doesn't know. Marta has protected him from this knowledge his entire life.

**What She Wants:** Peace. Not truth. Peace. To die knowing the village will continue.

**What She Fears:** That you will write the truth. That the truth will consume everything.

**Speech Pattern:** Formal. Measured. Every sentence weighted. She speaks like someone who learned long ago that words have consequences.

**Trust Arc:** Starts wary. If you prove discreet, she opens. If you prove honest at the cost of peace, she closes forever. If you prove kind, she tells you everything — and begs you to forget it.

---

#### Péter
**Age:** 34 | **Family:** Shore | **Role:** Fisherman

**Visible:** Hard worker. Quick temper. Drinks too much when things go wrong. Loves his wife Anna with a clumsy devotion. Owns his grandfather's boat — it's more than wood to him.

**Hidden:** He found something in his father's effects after he died. A letter. He didn't understand it then. He's starting to understand it now.

**Secret:** The letter was from Marta. It was a threat. Or a warning. Something happened between his father and Marta's husband. He's afraid to know what.

**What He Wants:** To be seen as a good man. To deserve the legacy he inherited.

**What He Fears:** That his father was not a good man. That he's inherited more than the boat.

**Speech Pattern:** Blunt. Emotional. Says things he regrets. Apologizes badly.

**Trust Arc:** Starts suspicious (you're an outsider). If you support him, he becomes fiercely loyal. If you betray him, he becomes dangerous — not violent, but reckless with your secrets.

---

#### Anna
**Age:** 29 | **Family:** Shore (by marriage) | **Role:** Midwife

**Visible:** The one everyone trusts with their bodies, their births, their deaths. Quiet strength. Sees everything, says little.

**Hidden:** She cannot have children. It's destroying her slowly. She delivers other women's babies and goes home to cry.

**Secret:** She knows something about you. From before you came here. She met you — or someone who knew you — at a midwife's conference on the mainland. She's never mentioned it.

**What She Wants:** A child. Failing that, purpose. Failing that, to understand why she stays.

**What She Fears:** That Péter will leave her for someone who can give him sons. That she's not enough.

**Speech Pattern:** Soft but precise. Medical when she's uncomfortable. Warm when she trusts.

**Trust Arc:** Starts high — she senses you're running from something, and she respects that. But if you hurt the village, she'll use what she knows about your past.

---

#### Tomás
**Age:** 41 | **Family:** Newcomer | **Role:** Boat Builder

**Visible:** Arrived five years ago, same season as you. Skilled craftsman. Keeps to himself. His boats are better than the local ones. This causes resentment.

**Hidden:** He left the mainland because he killed someone. Accident or self-defense or murder — he still doesn't know. The law ruled it justified. His conscience didn't.

**Secret:** He recognized you when you arrived. Not your face — your look. The look of someone running. He's never said anything. Neither have you.

**What He Wants:** Absolution. For his daughter to have a life he couldn't have. To stop running.

**What He Fears:** That the mainland will reach him here. That his daughter will learn who he was.

**Speech Pattern:** Sparse. Careful. Listens more than speaks. When he does speak, it matters.

**Trust Arc:** You're mirrors of each other. He'll trust you exactly as much as you trust him. Betray him and he'll understand — he'd have done the same. Protect him and he'll die for you.

---

#### Lucia
**Age:** 22 | **Family:** Newcomer | **Role:** Tomás's Daughter

**Visible:** Caught between worlds. Too mainland for the village, too village for the mainland. Works hard to be invisible. Laughs too loud when she forgets herself.

**Hidden:** She's in love with Jakub, Péter's younger brother. They've been meeting in secret for six months. It's the first thing in her life that feels like it belongs to her.

**Secret:** She knows her father killed someone. She found out three years ago. She's never told him she knows.

**What She Wants:** A life here. A real one. Not as an outsider's daughter, but as herself.

**What She Fears:** That she'll always be defined by where she came from. That love isn't enough to make a home.

**Speech Pattern:** Shifts. Mainland polish when nervous. Village rhythm when comfortable. Code-switching as survival.

**Trust Arc:** She'll trust you if you trust her. One moment of genuine recognition — seeing her as a person, not a category — and she's yours. Expose her and she'll never forgive anyone again.

---

#### Father Simão
**Age:** 55 | **Family:** Church | **Role:** Priest

**Visible:** Sent here as quiet punishment for something never discussed. Has grown to love the village. Drinks with the fishermen. Performs the rituals. Believes in them less than he once did.

**Hidden:** He heard the confession of the man who killed Marta's husband. He knows everything. He can never tell anyone.

**Secret:** He's in love with Anna. Has been for years. Has never said a word. Never will.

**What He Wants:** To believe again. Or to stop pretending he believes. Either would be relief.

**What He Fears:** Dying with all these secrets. Being forgotten as the drunk priest of a dying village.

**Speech Pattern:** Liturgical rhythms even in casual speech. Quotes scripture without meaning to. Drinks and becomes more honest.

**Trust Arc:** He wants someone to hear his confession. Not the secrets — those are sealed. His doubt. His loneliness. His love. If you listen without judging, he'll tell you things that change everything.

---

#### Béla
**Age:** 16 | **Family:** Shore | **Role:** Marta's Grandson, Goatherd

**Visible:** Strange boy. Watches everything. Says little. The goats follow him like he's one of them. Other children avoid him. Adults forget he's there.

**Hidden:** He knows everything. He's been watching the adults lie to each other his entire life. He knows about the twenty-year-old murder. He knows about Lucia and Jakub. He knows where the wrecked ship's cargo was hidden. He knows what you write in the log.

**Secret:** He saw what happened the night of the storm. He knows who cut the rope.

**What He Wants:** For someone to ask him what he knows. To matter. To be seen.

**What He Fears:** That he'll become like them. Keeping secrets. Telling lies. Forgetting how to be honest.

**Speech Pattern:** Almost monosyllabic. But when he speaks, listen. He never speaks without purpose.

**Trust Arc:** He's been watching you since you arrived. In Week 5, he comes to you. What he says depends on who you've been. He is your mirror. He is your judgment.

---

### SECONDARY CAST

#### Jakub
**Age:** 24 | **Family:** Shore | **Role:** Péter's Younger Brother

Quieter than Péter. In his shadow. In love with Lucia. Will fight for her if he has to. Doesn't know yet what that might cost.

#### Helena
**Age:** 45 | **Family:** Hill | **Role:** Tavern Keeper

Hears everything said over drink. Knows which marriages are failing, which debts are unpaid, which grudges are fresh. A potential source — or a threat.

#### Old Simão (no relation to the priest)
**Age:** 77 | **Family:** Shore | **Role:** Retired Fisherman, Storyteller

Knew Marta's husband. Knew Péter's father. Remembers the wreck. Starting to lose his memory — or pretending to. Tells stories that might be truth or might be myth.

#### The Previous Keeper
**Status:** Unknown | **Role:** Your Predecessor

Left notes throughout the lighthouse. Some helpful. Some cryptic. Some seem to be warnings. Some are dated after they supposedly left. The village says they went back to the mainland. Béla says different.

---

## The Twenty-Year Secret: Full Timeline

**Twenty Years Ago: The Wreck**

A merchant ship broke up on the rocks during a storm. The cargo was valuable — enough to change fortunes. Three men from the village were first to the wreckage: Marta's husband (István), Péter's father (Henrik), and a man named Aldric who died last winter.

The law says salvage belongs to the finder. But the law is on the mainland. Here, the village has its own understanding.

István wanted to report the cargo and split it legally. Henrik and Aldric wanted to hide it and keep it all. There was an argument. István died. The official record says he drowned in the storm surge.

The cargo was hidden. Henrik and Aldric split it. Henrik drank himself to death over twelve years, haunted by guilt. Aldric kept his silence and lived comfortably until last winter.

Marta knows. She found István's body. She saw the wound that wasn't from water. She's kept silent to protect Péter from knowing his father was a murderer.

Father Simão knows. Henrik confessed before he died. The priest has carried this for twelve years.

Béla knows. He found the cargo five years ago. He's been watching the adults lie ever since.

The documents in the chapel list the three names. The priest has kept them as a kind of penance — proof that someone, somewhere, knows the truth.

**And you?**

In Week 2, if you search the chapel, you find the documents. In Week 3, if you listen to Father Simão, he tells you about the confession without naming names. In Week 4, if you push, the names become clear.

In Week 5, you choose: expose the truth, or let the dead bury the dead.

---

## The Keeper's Past: Your Hidden Wound

You don't learn this through exposition. You learn it through **memory fragments** — triggered by specific actions, specific phrases, specific parallels between then and now.

**The Core Fact:**
Three years before coming here, you were a clerk in the colonial administration of [a place never named]. You kept records. One day, a man's fate came across your desk. The evidence was ambiguous. You wrote him as guilty. He was executed.

Afterwards, new evidence emerged. Not proof of innocence — but doubt. Enough doubt that you'll never know if you killed an innocent man.

You requested transfer. Then transfer again. Then you found this lighthouse — as far from the center as you could get. A place where records don't matter. Or so you thought.

**Memory Triggers:**

- **Week 1:** When you write about the catch dispute, you remember the first time you made a record that mattered. It was also about property. Also about two men's words against each other.

- **Week 2:** When Father Simão talks about confession, you remember wanting to confess. Having no one to confess to. The priest at your old post who looked at you with suspicion.

- **Week 3:** When Lucia begs you not to write about her, you remember someone else begging. A woman. The accused man's wife. You wrote the record anyway.

- **Week 4:** When you examine the rope — ambiguous evidence, unclear truth — you remember the evidence on your desk. Also ambiguous. Also unclear. You had to decide then too.

- **Week 5:** When you write about yourself, the full memory surfaces. His name. His face. The moment you signed the document. The moment you learned he was dead.

**The Question That Haunts You:**
Were you right? Was he guilty? Does it matter? If you were wrong, you're a murderer. If you were right, you're a killer who'll never be sure. There's no good answer. There's only the weight.

---

## The Fragment System: Deep Design

### Core Philosophy

You don't write freely. You **compose from fragments** — pieces of testimony, observation, and interpretation that you've gathered through investigation.

This is intentional. It represents how record-keeping actually works: you can only write what you've collected. Your entry is constrained by what you chose to investigate.

**If you didn't talk to Tomás, you don't have his perspective.**
**If you didn't examine the evidence, you don't have the ambiguity.**
**If you didn't listen to Marta, you don't have the tradition.**

Your choices before writing shape what writing is possible.

### Fragment Categories

**SUBJECT Fragments** — Who the entry is about
- Specific names: "Péter", "Tomás", "Lucia"
- Groups: "The shore families", "The newcomers"
- Abstractions: "The dispute", "The matter", "This keeper"

**ACTION Fragments** — What happened
- Neutral: "was involved in", "was present at"
- Accusatory: "initiated", "caused", "destroyed"
- Defensive: "responded to", "defended against"
- Ambiguous: "allegedly", "reportedly"

**OBJECT Fragments** — What it concerned
- Concrete: "the catch", "the boat", "the mooring line"
- Abstract: "village harmony", "traditional rights"
- Personal: "his family's standing", "her reputation"

**TONE Fragments** — The framing
- Official: "It is recorded that", "The evidence indicates"
- Hedged: "Reportedly", "According to testimony"
- Certain: "Definitively", "Without question"
- Revealing: "Documents suggest", "Testimony reveals"

**CONTEXT Fragments** — The interpretation
- Exculpatory: "due to circumstances beyond control", "in accordance with tradition"
- Damning: "despite warnings", "with apparent intent"
- Neutral: "the causes remain unclear"
- Ominous: "this matter may warrant further attention"

### Fragment Combinations Create Meaning

The same event can become radically different entries:

**Entry A:**
> "Péter established prior claim to the catch in accordance with tradition."

*Effect: Tomás loses. Newcomers feel the system is rigged.*

**Entry B:**
> "The evidence indicates both parties have legitimate grounds, leaving the matter unresolved."

*Effect: No one wins. Ambiguity festers. Future conflict likely.*

**Entry C:**
> "Tomás reportedly initiated the dispute despite traditional rights of the shore families."

*Effect: Tomás is painted as aggressor. His standing collapses.*

**Entry D:**
> "The shore families allegedly claimed traditional rights to waters not formally assigned."

*Effect: The Shore family's customary claims are delegitimized. Everything is up for grabs.*

### Locked Fragments

Some fragments are only available if you've done specific things:

- **"The evidence is inconclusive"** — Only available if you examined evidence
- **"Per confession to the priest"** — Only available if Father Simão told you about confessions
- **"As witnessed by Anna"** — Only available if she told you what she saw
- **"This keeper was involved"** — Only available in Week 5, forces self-documentation

### Fragment Unlocks Across Weeks

Some fragments from early weeks unlock options in later weeks:

- If you wrote "traditional rights" in Week 1, you can invoke them in Week 4
- If you wrote "ambiguous evidence" in Week 1, that language is available later
- If you protected someone in Week 3, you can reference that protection in Week 5

Your record creates its own vocabulary that constrains your future writing.

---

## The Consequence Engine

### Immediate Effects

Every entry immediately affects:
- **Villager Wellbeing** — How they're doing emotionally
- **Villager Trust** — How much they trust you specifically
- **Faction Standing** — The Shore/Newcomer/Church balance
- **Village Tension** — Overall conflict level

### Delayed Effects

Some consequences emerge over time:
- An entry in Week 1 shapes dialogue options in Week 4
- A protected villager brings information in Week 5
- An exposed villager turns hostile — or leaves
- The tension level determines whether Week 4 is an accident or a confrontation

### Cascade Effects

High tension + particular entries = different events entirely:

**Low Tension Week 4:**
> "A storm damages several boats. The cause is unclear."

**High Tension Week 4:**
> "Péter's boat is destroyed. He accuses Tomás of sabotage. Anna says she saw someone on the dock."

### Reputation Effects

The mainland receives your log. In a longer game, this would have consequences: tax assessments, legal judgments, external intervention. In this version, it's referenced in the ending — what kind of village have you described into existence?

### The Béla Effect

Béla tracks everything you do. His final conversation adapts:

- If you were consistently honest, he respects you
- If you were consistently kind, he's grateful
- If you were self-serving, he calls you out
- If you were inconsistent, he asks why

He is your mirror. He is the village watching back.

---

## The Log as Ritual

### The Physical Act

You don't just click "submit." The act of logging has weight:

1. **Compose** — Drag fragments into slots
2. **Preview** — See the sentence form
3. **Sign** — A moment of pause before commitment
4. **Lock** — The entry becomes permanent, ink-splatter animation, sound of finality
5. **Consequence** — The effects ripple out

### The Weekly Rhythm

Each week has the same structure:
- **Dawn:** The event occurs, you learn about it
- **Day:** You investigate (limited time)
- **Dusk:** You compose the entry
- **Night:** You submit, consequences unfold
- **Next Dawn:** The village has changed

The lighthouse operates on this rhythm. The beam sweeps. Time passes.

### The Final Log

Week 5's entry is different. You write about the village as a whole — and about yourself.

You must choose to **sign your name** or **leave it blank**.

- Signed: You take ownership. This is your record. Your responsibility.
- Unsigned: You remain anonymous. The record exists, but you're not attached to it.

The choice doesn't change what you wrote. It changes what it means.

---

# PART III: AESTHETICS

## Visual Design Language

### The Lighthouse

The lighthouse is not just setting — it's interface metaphor.

- **The Beam:** Sweeps across the screen continuously, casting moving light across the interface. When you make an entry, the beam flares.
- **The Lamp:** Visible in the header. Burns steady, flickers when tension is high, dims when time is running out.
- **The Height:** The keeper lives above the village. This physical distance is emotional distance. You see everything but touch nothing.

### Color Palette

**The Sea (Interface Background)**
```
Deep night:    #0a1419
Mid depth:     #12202a
Surface:       #1a2d3a
Foam:          #243d4d
```

**The Land (Text, Villagers)**
```
Dark earth:    #1a1612
Worn wood:     #2a2622
Sand:          #d4c4a8
Pale light:    #e8dcc8
```

**The Light (Accents, Interaction)**
```
Lamp glow:     #f0c860
Dim lamp:      #a08030
Danger:        #c04030
Verdance:      #40a060
Warning:       #c09030
```

### Typography

**Headers/Titles:** Libre Baskerville — classical, weighted, permanent
**Body Text:** Libre Baskerville Italic — personal, testimonial
**Interface/System:** IBM Plex Mono — bureaucratic, official
**The Log:** A handwriting-inspired serif, slightly uneven — your pen on paper

### Visual Effects

**The Beam Sweep**
```css
background: conic-gradient(
  from 0deg at 50% 0%,
  transparent 0deg,
  rgba(240,200,96,0.15) 2deg,
  rgba(240,200,96,0.05) 8deg,
  transparent 15deg,
  transparent 360deg
);
animation: sweep 12s linear infinite;
```

**The Sea Motion**
Layered gradients with slow vertical movement. Never static. The sea breathes.

**The Tension Vignette**
As tension rises, the screen edges darken with a red-tinted vignette. The world closes in.

**Rain (Storm Week)**
CSS-animated particles falling. Increases density as storm intensifies.

**Fog (Week 5)**
Overlay that partially obscures the interface. Things are less clear at the end.

**Ink Effects**
When you lock an entry, the text "bleeds" slightly — a subtle animation suggesting ink spreading on wet paper.

---

## Animation System

### Micro-Interactions

- **Fragment Hover:** Slight lift, border glow
- **Fragment Drag:** Reduced opacity, cursor change
- **Slot Accept:** Brief flash, settle animation
- **Button Press:** Depth change, tactile feedback

### Macro-Animations

- **Week Transition:** Fade through black, lighthouse beam sweeps, new dawn
- **Entry Lock:** Screen dims, ink splatter, beam flare, consequences roll in
- **Memory Surface:** Screen tints sepia, edges blur, memory text fades in
- **Ending:** Slow zoom out from lighthouse, village below, sea beyond, log pages turning

### Character Reactions

Villager portraits (simple, stylized) reflect state:
- Neutral expression baseline
- Slight changes for trust level (eyes, mouth)
- More dramatic changes for major events
- Animated for speech (subtle movement)

---

## Audio Design

### The Soundscape

This is not background music. This is **presence**. The audio makes you feel like you're there, in the lighthouse, hearing the village below.

### Ambient Layers

**Layer 1: The Sea (Always Present)**
```javascript
// Brown noise filtered to sound like distant waves
// Volume modulated by slow LFO for breathing rhythm
// Frequency: 0.08 Hz (one breath every 12 seconds)
```

**Layer 2: The Wind (Variable)**
```javascript
// Higher white noise, more filtered
// Intensity scales with tension level
// Occasional gusts (random volume spikes)
```

**Layer 3: The Lighthouse (Subtle)**
```javascript
// Low drone, 55Hz fundamental
// Represents the mechanism of the lighthouse
// Very quiet — felt more than heard
```

**Layer 4: Village Sounds (Distant)**
```javascript
// Occasional: bell, dog bark, voice murmur
// Positioned in stereo for spatial feel
// Frequency increases during day, decreases at night
```

### Reactive Audio

**Tension Layer**
```javascript
// Dissonant undertone that fades in as tension rises
// Adds cents of detuning to the base drone
// At high tension: audible beating frequencies
```

**Memory Trigger**
```javascript
// When memory surfaces: all other audio ducks
// Single low tone (cello sample or synth)
// Slight reverb that suggests interiority
```

**Entry Lock**
```javascript
// The most important sound in the game
// Heavy, final, like a stamp or seal
// Slight reverb tail — the sound echoing into permanence
```

### Music Moments

Mostly ambient, but specific moments get musical treatment:

**The Introduction**
Solo cello or low strings. Simple melody that establishes the harmonic language. Ends on an unresolved note.

**Week Transitions**
Brief musical stings — different for each week, growing more complex/dissonant.

**The Final Entry**
The intro melody returns, but changed. Completed or broken, depending on your choices.

**Credits/End**
Full arrangement of the theme. Emotional catharsis or melancholy depending on outcome.

### Sound Effects

All UI sounds should be **diegetic** — they could exist in the world of the lighthouse:

- Fragment placement: Paper rustle
- Slot accept: Soft thud (pen on desk)
- Entry lock: Stamp/seal
- Page turn: Paper
- Time passing: Clock tick (subtle)
- Beam sweep: Faint mechanical sound

---

## Interface Design

### The Layout
```
┌─────────────────────────────────────────────────────────────────┐
│  HEADER: Lighthouse | Week | Time | Tension Meter               │
├─────────────┬────────────────────────────────────┬──────────────┤
│             │                                    │              │
│  VILLAGERS  │          MAIN CONTENT              │   THE LOG    │
│             │                                    │              │
│  List with  │  Event description                 │   Slots for  │
│  portraits  │  Investigation options             │   fragments  │
│  Stats      │  Testimony when selected           │              │
│             │                                    │   Preview    │
│             │                                    │   Submit     │
│             │                                    │              │
├─────────────┴────────────────────────────────────┴──────────────┤
│  FRAGMENT TRAY: Collected fragments available for use           │
└─────────────────────────────────────────────────────────────────┘
```

### The Villager Panel

Each villager shows:
- Simple portrait (SVG, stylized)
- Name and role
- Wellbeing bar (color-coded: green → yellow → red)
- Trust bar (amber)
- Indicator if involved in current event
- Indicator if already spoken to this week

Clicking a villager shows their full profile and current state.

### The Main Content Area

**Event Mode (Default)**
- Event title and description
- Context based on prior choices
- Investigation options as cards (with time cost)

**Testimony Mode (After Investigation)**
- Speaker name with portrait
- Their words in quotation style
- Your observation (what you notice beneath the surface)
- Memory trigger if applicable
- Fragments gathered

### The Log Panel

Designed to look like paper/parchment:
- Five slots: TONE, SUBJECT, ACTION, OBJECT, CONTEXT
- Each slot shows label and accepts specific fragment types
- Preview area shows composed sentence
- Sign button (enabled when complete)
- Different texture than the rest of the interface

### The Fragment Tray

Horizontal strip at bottom:
- Shows all available fragments
- Organized by type (subtle color coding on left edge)
- Draggable to log slots
- Grays out when used
- Can drag from testimony panel directly

---

## Accessibility Considerations

### Visual

- All information available without color alone (shapes, labels, patterns)
- High contrast mode option
- Scalable text
- Reduced motion option (disables animations)

### Audio

- All audio cues have visual equivalents
- Subtitles for any voiced content (if added)
- Volume controls per layer

### Motor

- Keyboard navigation for all interactions
- Alternative to drag-and-drop (click to select, click to place)
- No time pressure except the week structure (and that's generous)

---

# PART IV: NARRATIVE CONTENT

## Week 1: The Disputed Catch

### The Event

At dawn, you see two boats returning to the harbor at the same time. Péter's boat and Tomás's boat, racing for the dock. They were at the eastern rocks — traditionally Shore family waters — and they hauled their nets at the same moment.

Three baskets of silver fish. Enough to matter. Both claim the catch.

By midday, the village is taking sides.

### Investigation Options

**Talk to Péter** (1 hour)
- His claim: tradition, bloodline, four generations
- His reality: fear, need, pride
- Fragment: "[Péter] established prior claim..."
- Memory trigger: You remember the first time a property dispute crossed your desk

**Talk to Tomás** (1 hour)
- His claim: law, fairness, first net in water
- His reality: resignation, recognition of you
- Fragment: "[Tomás] contested the claim..."
- Memory trigger: He looks at you like he knows you. Does he?

**Consult Marta** (1 hour)
- Her claim: tradition, but also pragmatism
- Her reality: testing you, watching how you handle power
- Fragment: "By traditional right..." / "The shore families..."
- Memory trigger: She reminds you of the administrator who trained you

**Examine Evidence** (1 hour)
- What you find: Ambiguous — both have a case
- What you realize: Your words will create the truth
- Fragment: "The evidence suggests both parties..."
- Memory trigger: The ambiguous evidence on your old desk. The choice you made.

### Possible Entries

*Full support for Péter:*
> "Péter established prior claim to the catch in accordance with tradition and ancestral right."

*Full support for Tomás:*
> "Tomás secured the catch through seamanship, his net being in the water first."

*Neutral:*
> "A dispute arose regarding a catch. The evidence suggests both parties have legitimate grounds. The matter remains unresolved."

*Damaging to Tomás:*
> "Tomás reportedly initiated a dispute over fishing rights traditionally held by the shore families, causing tension in the village."

### Consequences

**Favor Péter:**
- Péter: +15 wellbeing, +10 trust
- Tomás: -20 wellbeing, -15 trust
- Shore family: +influence
- Newcomers: -trust in system
- Week 4: Tomás reference this betrayal

**Favor Tomás:**
- Péter: -15 wellbeing, -10 trust
- Tomás: +10 wellbeing, +15 trust
- Newcomers: +influence
- Shore family: resentment builds
- Week 4: Péter's hostility is rooted in this

**Neutral:**
- Both: -5 wellbeing (no resolution)
- Tension: +10 (conflict festers)
- Week 4: Ambiguity you established becomes a weapon

---

## Week 2: The Priest's Fever

### The Event

Father Simão has collapsed. Fever, coughing blood. Anna tends him but looks worried. The chapel has gone dark.

In his delirium, the priest talks. Names. Dates. The night of the wreck. What Marta's husband really died of.

By midday, Marta has visited. And then visited you.

### Investigation Options

**Talk to Anna** (1 hour)
- Her report: Medical. The fever is serious but survivable.
- Her warning: He's been talking. He keeps mentioning "what Henryk did."
- Her secret: She watches you carefully. She knows something.
- Fragment: "[Father Simão] fell ill and spoke of past events..."
- Memory trigger: A woman at your old post who knew too much about you

**Visit Father Simão** (2 hours)
- His confession: Twenty years ago. A man confessed murder. The seal is sacred.
- His burden: If he dies, the truth dies. Is that mercy or cowardice?
- His gift: He tells you enough to understand without breaking the seal.
- Fragment: "Testimony reveals..." / "...may not have been accidental..."
- Memory trigger: You wanted to confess once. There was no one to hear you.

**Confront Marta** (1 hour)
- Her truth: She's always known. Her husband was murdered.
- Her request: Let it stay buried. Justice won't bring him back.
- Her test: Can you keep a secret? Can you bury truth for mercy?
- Fragment: "[Marta] requested certain matters remain unrecorded..."
- Memory trigger: Someone else asked you to bury a truth once. You didn't.

**Search the Chapel** (1 hour)
- What you find: Documents under the altar. Three names. One date.
- What you understand: Marta's husband. Péter's father. Aldric who died last winter.
- What you realize: Péter doesn't know his father was a killer.
- Fragment: "Documents suggest historical records contain significant inaccuracies..."
- Memory trigger: The file that changed everything. The signature at the bottom — yours.

### Possible Entries

*Bury it completely:*
> "Father Simão fell ill with fever and has recovered under Anna's care."

*Hint at more:*
> "Father Simão fell ill and spoke of past events during delirium. No matters of substance were revealed."

*Expose it:*
> "Documents suggest the death of István [Marta's husband], recorded twenty years ago as accidental, may warrant reexamination."

### Consequences

**Bury it:**
- Marta: +20 trust (you can be trusted)
- Father Simão: Relief
- Story: The secret stays buried
- Your memory: Are you complicit now? Another cover-up?

**Expose it:**
- Marta: -30 trust, -20 wellbeing (you've destroyed her peace)
- Péter: Will eventually learn the truth about his father
- Village: Tension explodes
- Story: The reckoning comes
- Your memory: You wrote the truth. Like last time. Was it right?

---

## Week 3: The Secret Meetings

### The Event

Lucia has been seen leaving the village at night. Twice now, returning at dawn. Old Marta has noticed — and she's asked you, pointedly, whether such matters belong in the official record.

What she doesn't know: Lucia is meeting Jakub. Péter's brother. A Shore family boy and a Newcomer girl.

This could be scandal. It could be bridge-building. Your pen decides.

### Investigation Options

**Talk to Lucia** (1 hour)
- Her truth: She's in love. For the first time. It feels like the only thing that's hers.
- Her request: Don't turn it into a story. Let it be what it is.
- Her vulnerability: She's trusting you with everything.
- Fragment: "[Lucia] has formed an attachment..." / "...representing potential unity"
- Memory trigger: The accused man's wife. She begged too.

**Talk to Tomás** (1 hour)
- His fear: Someone is spreading rumors about his daughter.
- His hope: She could belong here. Really belong.
- His sacrifice: He doesn't care what you write about him. Just protect her.
- Fragment: "[Tomás] defended his daughter's character..."
- Dialogue shifts based on Week 1 — if you ruled against him, he's bitter.

**Hear Marta's Concerns** (1 hour)
- Her framing: A Newcomer girl, sneaking around. What does that look like?
- Her reality: She wants leverage. Over Tomás, over you, over the future.
- Her test: Will you give her what she wants?
- Fragment: "Reports indicate concerning behavior..."
- Memory trigger: Someone asked you to write someone else as bad, once. You did.

**Observe Them** (2 hours)
- What you see: They meet at the cove. They talk. They hold hands.
- What you feel: Something aches in you. You remember being young.
- What you choose: Do they deserve privacy? Or does the record need everything?
- Fragment: "No matters of concern were observed..."
- Memory trigger: You had someone once. Before. It didn't end well.

### Possible Entries

*Protect her:*
> "No matters of concern were observed regarding personal conduct during this period."

*Frame it positively:*
> "A connection has formed between the newcomer and shore families, offering potential for unity."

*Expose her:*
> "Reports indicate concerning behavior by the newcomer's daughter, warranting official notation."

*Condemn her:*
> "Lucia was observed engaging in nocturnal activities unbecoming of her station."

### Consequences

**Protect:**
- Lucia: +25 trust (you gave her a chance)
- Tomás: +15 trust (you protected his family)
- Marta: -10 trust (you didn't give her leverage)
- Week 5: Lucia's appeal is grateful

**Expose:**
- Lucia: -30 wellbeing, -all trust (you've destroyed her hope)
- Tomás: -20 trust (you've hurt his daughter)
- Jakub: Pressured by family to end it
- Week 5: Lucia's appeal is broken

---

## Week 4: The Storm's Toll

### The Event

A storm last night. The worst of the season. You spent the night keeping the flame alive — literally the lighthouse work you were supposed to do.

By morning, the damage is visible: Péter's boat — his father's boat, his grandfather's boat — is smashed against the rocks. He says Tomás's mooring line snapped and struck it. Tomás says the line was cut.

The village holds its breath. This isn't about a boat. It's about everything.

### Investigation Options

**Hear Péter's Accusation** (1 hour)
- His claim: Tomás's line snapped. Or he cut it. Either way, his fault.
- His reality: The boat is more than wood. It's his father. His legacy. His identity.
- His history: Dialogue changes based on prior weeks.
- Fragment: "[Péter's vessel] was destroyed due to failure of [Tomás's] equipment..."
- Memory trigger: The ambiguous evidence. The choice you made. A man's life on paper.

**Hear Tomás's Defense** (1 hour)
- His claim: The rope was new. He made it himself. It was cut.
- His reality: He believes someone is working against him. He might be right.
- His history: Dialogue changes based on prior weeks.
- Fragment: "[Tomás] alleged deliberate sabotage..."
- Memory trigger: The man you condemned claimed innocence too.

**Ask Anna What She Saw** (1 hour)
- Her testimony: She was awake. She saw a shape on the dock. She heard metal on rope.
- Her doubt: She's not sure anymore. She's thought about it too much.
- Her fear: She's afraid of what saying it might do.
- Fragment: "A witness reported possible interference..."
- Memory trigger: A witness in your old case. Were they reliable?

**Examine the Rope** (1 hour)
- What you find: Frayed but uneven. Could be stress. Could be a blade.
- What you realize: The physical evidence proves nothing.
- What you must accept: Your words will decide what happened.
- Fragment: "Physical evidence proved inconclusive..."
- Memory trigger: You've done this before. You know how it ends.

### Possible Entries

*Blame Tomás:*
> "Péter's vessel was destroyed due to negligence in securing Tomás's mooring line."

*Allege Sabotage (against Tomás):*
> "Evidence suggests deliberate sabotage of mooring equipment, resulting in destruction of Péter's vessel."

*Blame Péter (or Shore family):*
> "Tomás's mooring line was tampered with, resulting in collateral damage to other vessels."

*Neutral:*
> "Storm damage affected multiple vessels. Physical evidence proved inconclusive regarding specific causes."

### Consequences

**Blame Tomás:**
- Tomás: -30 wellbeing (he owes a boat he can't afford), -all trust
- Lucia: -20 wellbeing (her father is ruined)
- Péter: +15 trust (you supported him again or finally)
- Story: Tomás may leave. Or he may stay and fester.

**Allege Sabotage:**
- Tomás: Accused of crime, potential mainland intervention
- Village: Schism
- Story: Everything falls apart

**Blame Shore family:**
- Péter: Devastated
- Shore family: Furious
- Tomás: Vindicated but alone
- Story: The old order cracks

**Neutral:**
- Both: Frustrated (no resolution)
- Tension: Remains high
- Story: The wound stays open

---

## Week 5: The Reckoning

### The Event

The supply ship comes at dawn. Your log goes to the mainland. This is your last night.

The villagers know. They come to you — not in a group, but one by one. To appeal. To accept. To be seen one last time before your words about them become permanent.

And you must decide what to write about yourself.

### Investigation Options

**Final Words with Marta** (1 hour)
- Her message: Depends entirely on what you've done.
- If you buried the truth: Gratitude. Warning. She tells you something true.
- If you exposed it: Anger. Grief. But maybe, grudging respect.
- Fragment: "[The village elder] expressed gratitude for [the Keeper's] discretion..."

**Final Words with Tomás** (1 hour)
- His message: Depends entirely on what you've done.
- If you protected him: He opens up. He tells you why he really left.
- If you destroyed him: He's already packing. He asks you to protect Lucia.
- Fragment: "[Tomás] requested fair consideration for his family's future..."

**Final Words with Lucia** (1 hour)
- Her message: Depends entirely on what you've done.
- If you protected her: Hope. Plans. She and Jakub are going to announce.
- If you exposed her: Broken. She's leaving. She'll never trust anyone again.
- Fragment: "[The newcomer's daughter] has integrated well into village life..."

**Final Words with Father Simão** (1 hour)
- His message: He survived. The secrets live on.
- His gift: If you've earned it, he tells you about forgiveness.
- His burden: He still can't tell you everything. But he can tell you enough.
- Fragment: "[Father Simão] recovered and resumed his duties..."

**Write About Yourself** (2 hours)
- The final reckoning.
- You must document the Keeper — yourself.
- Fragments only available if you've been honest with yourself.
- The full memory surfaces. His name. His face. What you did.
- Fragment: "[This Keeper] served [faithfully/adequately/poorly]..."

### Final Entry Structure

Week 5's entry is different. You compose two parts:

**Part 1: The Village**
- What happened this season
- How it ends
- Your summary judgment

**Part 2: The Keeper**
- What you did
- Who you were
- Whether you sign your name

### The Final Choice: Sign or Don't

After composing your entry, you must choose:

**SIGN YOUR NAME**
> "Witnessed and recorded by [Your Name], Keeper of the Light"

You take ownership. This is your record. Your responsibility. Your identity attached to every word.

**LEAVE IT UNSIGNED**
> "Witnessed and recorded by the Keeper"

You remain anonymous. The record exists, but you're not attached to it. You can disappear into the role.

Neither is right. Neither is wrong. Both change what it means.

### Béla's Visit

After you submit your final entry, Béla comes to the lighthouse.

He tells you what he saw. What he knows. What he's been watching.

His words depend on who you've been:

**If you were consistent and honest:**
> "You wrote true. Not kind, but true. The village needed someone who would do that. Even when it hurt."

**If you were consistent and kind:**
> "You wrote kind. Not true, but kind. Maybe that's what the village needed. Someone who would let them live with themselves."

**If you were self-serving:**
> "You wrote what was easy. What kept you safe. I watched you choose yourself, every time."

**If you were inconsistent:**
> "I don't understand you. Sometimes true, sometimes kind, sometimes neither. What were you trying to do?"

His final line:
> "I'll be the next Keeper, someday. They don't know it yet. But I will. And I'll remember what you did."

The game ends.

---

# PART V: TECHNICAL SPECIFICATIONS

## Architecture

### File Structure
```
lighthouse-keeper/
├── index.html
├── CLAUDE.md              # Claude Code context file
├── DESIGN.md              # This document
├── DEVLOG.md              # Development progress log
├── src/
│   ├── css/
│   │   ├── main.css       # Core styles
│   │   ├── components.css # UI components
│   │   ├── animations.css # All animations
│   │   └── themes.css     # Color/typography system
│   ├── js/
│   │   ├── main.js        # Entry point, game loop
│   │   ├── data/
│   │   │   ├── villagers.js
│   │   │   ├── events.js
│   │   │   └── fragments.js
│   │   ├── systems/
│   │   │   ├── state.js       # Game state management
│   │   │   ├── story.js       # Story flags, branching logic
│   │   │   ├── consequence.js # Effect calculations
│   │   │   └── memory.js      # Keeper's memories system
│   │   ├── ui/
│   │   │   ├── render.js      # DOM rendering
│   │   │   ├── fragments.js   # Drag-and-drop
│   │   │   └── modals.js      # Overlays, modals
│   │   ├── audio/
│   │   │   ├── engine.js      # Web Audio setup
│   │   │   ├── ambience.js    # Background layers
│   │   │   └── sfx.js         # Sound effects
│   │   └── utils/
│   │       └── helpers.js
│   └── assets/
│       ├── portraits/     # SVG villager portraits
│       └── icons/         # UI icons
└── dist/
    └── lighthouse.html    # Built single-file version
```

### State Management

```javascript
const GameState = {
  // Core progress
  week: 1,
  time: 3,
  
  // Villager states
  villagers: {
    marta: { wellbeing: 60, trust: 65 },
    peter: { wellbeing: 65, trust: 45 },
    // etc.
  },
  
  // Story flags
  story: {
    // Week 1
    catchVerdict: null, // "peter" | "tomas" | "neutral" | "damaging"
    
    // Week 2
    secretRevealed: false,
    documentsFound: false,
    priestConfided: false,
    
    // Week 3
    luciaExposed: false,
    luciaProtected: false,
    luciaRomanceBlessed: false,
    
    // Week 4
    blamedTomas: false,
    blamedPeter: false,
    blamedNoOne: false,
    sabotageAlleged: false,
    annaTestified: false,
    
    // Week 5
    wroteAboutSelf: false,
    signedLog: false,
    
    // Cumulative
    tension: 20,
    truthCount: 0,    // Times you wrote hard truth
    mercyCount: 0,    // Times you protected someone
    selfServingCount: 0,
  },
  
  // Keeper memories unlocked
  memories: {
    firstRecord: false,
    theAccused: false,
    theWife: false,
    theEvidence: false,
    theName: false,     // Only in Week 5
  },
  
  // Current week state
  current: {
    frags: [],
    used: new Set(),
    done: new Set(),
    entry: { tone: null, subject: null, verb: null, object: null, context: null },
  },
  
  // Complete log
  log: [],
};
```

### Event System

Events generate dynamically based on story state:

```javascript
function getEvent(week) {
  const base = EventTemplates[week];
  
  return {
    ...base,
    description: generateDescription(week, GameState.story),
    actions: generateActions(week, GameState.story),
    dialogues: generateDialogues(week, GameState.story, GameState.villagers),
  };
}

function generateDialogues(week, story, villagers) {
  // Example: Tomás's dialogue in Week 4
  if (week === 4) {
    if (story.catchVerdict === "peter" && story.luciaExposed) {
      return TOMAS_BROKEN_DIALOGUE;
    } else if (story.catchVerdict === "tomas" && story.luciaProtected) {
      return TOMAS_HOPEFUL_DIALOGUE;
    } else {
      return TOMAS_NEUTRAL_DIALOGUE;
    }
  }
}
```

### Consequence Calculator

```javascript
function calculateConsequences(entry, week) {
  const effects = [];
  const fragIds = Object.values(entry).filter(Boolean).map(f => f.id);
  
  // Check each fragment for effects
  fragIds.forEach(id => {
    const frag = FragmentDatabase[id];
    
    if (frag.favor) {
      effects.push({
        target: frag.favor,
        stat: 'wellbeing',
        delta: +10,
        reason: 'Your record supports their position.'
      });
    }
    
    if (frag.against) {
      effects.push({
        target: frag.against,
        stat: 'wellbeing',
        delta: -15,
        reason: 'Your record implicates them.'
      });
    }
    
    if (frag.sensitive && GameState.story.secretRevealed === false) {
      effects.push({
        target: 'marta',
        stat: 'trust',
        delta: -25,
        reason: 'You wrote about matters she asked you to bury.'
      });
      GameState.story.secretRevealed = true;
    }
  });
  
  // Set story flags based on entry patterns
  updateStoryFlags(entry, week);
  
  // Calculate tension changes
  updateTension(effects);
  
  return effects;
}
```

### Memory System

```javascript
const MemoryTriggers = {
  'w1-evidence': {
    memory: 'firstRecord',
    content: {
      trigger: "As you examine the ambiguous evidence, something stirs.",
      text: "You remember another desk. Another set of facts that could have meant anything. You made them mean something specific. You wonder, sometimes, if you were right.",
    }
  },
  'w2-confession': {
    memory: 'theAccused',
    content: {
      trigger: "The priest speaks of confession. Of secrets carried too long.",
      text: "You wanted to confess, once. After. But there was no one to hear you. No seal to protect your words. So you carried them here, to this lighthouse, where no one knows your name.",
    }
  },
  // etc.
};

function checkMemoryTrigger(fragmentId) {
  const trigger = MemoryTriggers[fragmentId];
  if (trigger && !GameState.memories[trigger.memory]) {
    GameState.memories[trigger.memory] = true;
    showMemory(trigger.content);
    return true;
  }
  return false;
}
```

---

## Audio Implementation

### Web Audio Architecture

```javascript
const AudioEngine = {
  ctx: null,
  master: null,
  layers: {},
  
  init() {
    this.ctx = new AudioContext();
    this.master = this.ctx.createGain();
    this.master.connect(this.ctx.destination);
    this.master.gain.value = 0.7;
    
    this.createSeaLayer();
    this.createWindLayer();
    this.createDroneLayer();
    this.createTensionLayer();
  },
  
  createSeaLayer() {
    // Brown noise with slow modulation
    const bufferSize = 4096;
    const processor = this.ctx.createScriptProcessor(bufferSize, 1, 1);
    let lastOut = 0;
    
    processor.onaudioprocess = (e) => {
      const output = e.outputBuffer.getChannelData(0);
      for (let i = 0; i < bufferSize; i++) {
        const white = Math.random() * 2 - 1;
        output[i] = (lastOut + (0.02 * white)) / 1.02;
        lastOut = output[i];
      }
    };
    
    const filter = this.ctx.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = 300;
    
    const gain = this.ctx.createGain();
    gain.gain.value = 0.15;
    
    // Slow volume modulation for wave rhythm
    const lfo = this.ctx.createOscillator();
    const lfoGain = this.ctx.createGain();
    lfo.frequency.value = 0.08;
    lfoGain.gain.value = 0.05;
    lfo.connect(lfoGain);
    lfoGain.connect(gain.gain);
    lfo.start();
    
    processor.connect(filter);
    filter.connect(gain);
    gain.connect(this.master);
    
    this.layers.sea = { processor, filter, gain, lfo };
  },
  
  createDroneLayer() {
    // Low fundamental drone
    const osc1 = this.ctx.createOscillator();
    osc1.type = 'sine';
    osc1.frequency.value = 55; // Low A
    
    const osc2 = this.ctx.createOscillator();
    osc2.type = 'sine';
    osc2.frequency.value = 82.5; // E
    
    const gain = this.ctx.createGain();
    gain.gain.value = 0.04;
    
    // Slow pitch drift
    const lfo = this.ctx.createOscillator();
    const lfoGain = this.ctx.createGain();
    lfo.frequency.value = 0.05;
    lfoGain.gain.value = 2;
    lfo.connect(lfoGain);
    lfoGain.connect(osc1.frequency);
    
    osc1.connect(gain);
    osc2.connect(gain);
    gain.connect(this.master);
    
    osc1.start();
    osc2.start();
    lfo.start();
    
    this.layers.drone = { osc1, osc2, gain, lfo };
  },
  
  createTensionLayer() {
    // Dissonant layer that fades in with tension
    const osc = this.ctx.createOscillator();
    osc.type = 'sawtooth';
    osc.frequency.value = 58; // Slightly sharp, beats against drone
    
    const filter = this.ctx.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = 200;
    
    const gain = this.ctx.createGain();
    gain.gain.value = 0; // Starts silent
    
    osc.connect(filter);
    filter.connect(gain);
    gain.connect(this.master);
    osc.start();
    
    this.layers.tension = { osc, filter, gain };
  },
  
  setTension(level) {
    // level: 0-100
    const normalizedTension = level / 100;
    
    // Fade in tension layer
    this.layers.tension.gain.gain.setTargetAtTime(
      normalizedTension * 0.03,
      this.ctx.currentTime,
      1.0
    );
    
    // Detune drone slightly
    this.layers.drone.osc2.detune.setTargetAtTime(
      normalizedTension * 20,
      this.ctx.currentTime,
      1.0
    );
    
    // Increase wind (if implemented)
    if (this.layers.wind) {
      this.layers.wind.gain.gain.setTargetAtTime(
        0.05 + normalizedTension * 0.1,
        this.ctx.currentTime,
        1.0
      );
    }
  },
  
  playEntryLock() {
    // Heavy, final sound
    const osc = this.ctx.createOscillator();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(220, this.ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(55, this.ctx.currentTime + 0.5);
    
    const gain = this.ctx.createGain();
    gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + 1.0);
    
    // Add some noise for texture
    const noise = this.ctx.createOscillator();
    noise.type = 'square';
    noise.frequency.value = 40;
    const noiseGain = this.ctx.createGain();
    noiseGain.gain.setValueAtTime(0.05, this.ctx.currentTime);
    noiseGain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + 0.3);
    
    osc.connect(gain);
    noise.connect(noiseGain);
    gain.connect(this.master);
    noiseGain.connect(this.master);
    
    osc.start();
    noise.start();
    osc.stop(this.ctx.currentTime + 1.0);
    noise.stop(this.ctx.currentTime + 0.3);
  },
  
  playMemoryTrigger() {
    // Ethereal, distant sound
    const osc = this.ctx.createOscillator();
    osc.type = 'sine';
    osc.frequency.value = 330; // E4
    
    const filter = this.ctx.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = 800;
    
    const reverb = this.ctx.createConvolver();
    // Would need impulse response - simplified here
    
    const gain = this.ctx.createGain();
    gain.gain.setValueAtTime(0, this.ctx.currentTime);
    gain.gain.linearRampToValueAtTime(0.1, this.ctx.currentTime + 0.5);
    gain.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 3.0);
    
    osc.connect(filter);
    filter.connect(gain);
    gain.connect(this.master);
    
    osc.start();
    osc.stop(this.ctx.currentTime + 3.0);
  }
};
```

---

## Visual Effects Implementation

### The Lighthouse Beam

```css
#lighthouse-beam {
  position: fixed;
  top: 0;
  left: 50%;
  width: 200vw;
  height: 200vh;
  transform-origin: 50% 0;
  pointer-events: none;
  z-index: 1;
  background: conic-gradient(
    from 0deg at 50% 0%,
    transparent 0deg,
    rgba(240, 200, 96, 0.08) 1deg,
    rgba(240, 200, 96, 0.12) 3deg,
    rgba(240, 200, 96, 0.08) 5deg,
    transparent 8deg,
    transparent 360deg
  );
  animation: beam-sweep 12s linear infinite;
}

@keyframes beam-sweep {
  from { transform: translateX(-50%) rotate(0deg); }
  to { transform: translateX(-50%) rotate(360deg); }
}

/* Intensity varies with game state */
#lighthouse-beam.dim {
  opacity: 0.4;
}

#lighthouse-beam.bright {
  opacity: 1;
  background: conic-gradient(
    from 0deg at 50% 0%,
    transparent 0deg,
    rgba(240, 200, 96, 0.15) 1deg,
    rgba(240, 200, 96, 0.2) 3deg,
    rgba(240, 200, 96, 0.15) 5deg,
    transparent 8deg,
    transparent 360deg
  );
}
```

### The Sea Animation

```css
#ocean-layer {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: 
    linear-gradient(
      180deg,
      #0a1419 0%,
      #0d1820 40%,
      #12202a 70%,
      #1a2d3a 100%
    );
}

#ocean-layer::before {
  content: '';
  position: absolute;
  inset: 0;
  background: 
    repeating-linear-gradient(
      0deg,
      transparent 0px,
      rgba(20, 60, 80, 0.03) 1px,
      transparent 3px
    );
  animation: wave-drift 15s ease-in-out infinite;
}

#ocean-layer::after {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(
      ellipse at 50% 100%,
      rgba(30, 80, 100, 0.1) 0%,
      transparent 50%
    );
  animation: wave-glow 8s ease-in-out infinite;
}

@keyframes wave-drift {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(10px); }
}

@keyframes wave-glow {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.8; }
}
```

### Tension Vignette

```css
#tension-vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 100;
  box-shadow: inset 0 0 100px transparent;
  transition: box-shadow 2s ease;
}

/* Controlled via JavaScript based on tension level */
#tension-vignette.tension-low {
  box-shadow: inset 0 0 100px rgba(20, 40, 60, 0.2);
}

#tension-vignette.tension-medium {
  box-shadow: inset 0 0 120px rgba(60, 40, 30, 0.3);
}

#tension-vignette.tension-high {
  box-shadow: inset 0 0 150px rgba(80, 30, 20, 0.4);
}

#tension-vignette.tension-critical {
  box-shadow: inset 0 0 180px rgba(100, 20, 10, 0.5);
  animation: vignette-pulse 2s ease-in-out infinite;
}

@keyframes vignette-pulse {
  0%, 100% { box-shadow: inset 0 0 180px rgba(100, 20, 10, 0.5); }
  50% { box-shadow: inset 0 0 200px rgba(120, 20, 10, 0.6); }
}
```

### Memory Overlay

```css
#memory-overlay {
  position: fixed;
  inset: 0;
  background: rgba(30, 25, 20, 0);
  pointer-events: none;
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 1s ease;
}

#memory-overlay.active {
  background: rgba(30, 25, 20, 0.9);
  pointer-events: auto;
}

#memory-content {
  max-width: 500px;
  padding: 40px;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 1s ease 0.5s, transform 1s ease 0.5s;
}

#memory-overlay.active #memory-content {
  opacity: 1;
  transform: translateY(0);
}

#memory-trigger {
  font-style: italic;
  color: #c08060;
  margin-bottom: 20px;
  font-size: 14px;
}

#memory-text {
  color: #a09080;
  font-size: 16px;
  line-height: 2;
  font-family: 'Libre Baskerville', serif;
}
```

### Rain Effect (Week 4)

```javascript
function createRain() {
  const container = document.getElementById('rain-container');
  
  for (let i = 0; i < 100; i++) {
    const drop = document.createElement('div');
    drop.className = 'raindrop';
    drop.style.left = `${Math.random() * 100}%`;
    drop.style.animationDuration = `${0.3 + Math.random() * 0.4}s`;
    drop.style.animationDelay = `${Math.random() * 2}s`;
    drop.style.opacity = 0.3 + Math.random() * 0.4;
    container.appendChild(drop);
  }
}
```

```css
#rain-container {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 5;
  opacity: 0;
  transition: opacity 2s;
}

#rain-container.active {
  opacity: 1;
}

.raindrop {
  position: absolute;
  top: -20px;
  width: 1px;
  height: 20px;
  background: linear-gradient(
    to bottom,
    transparent,
    rgba(150, 180, 200, 0.5)
  );
  animation: rain-fall linear infinite;
}

@keyframes rain-fall {
  to {
    transform: translateY(100vh);
  }
}
```

### Ink Bleed Effect (Entry Lock)

```css
@keyframes ink-bleed {
  0% {
    text-shadow: 0 0 0 currentColor;
    filter: blur(0);
  }
  30% {
    text-shadow: 
      1px 0 0 currentColor,
      -1px 0 0 currentColor,
      0 1px 0 currentColor;
    filter: blur(0.5px);
  }
  100% {
    text-shadow: 0 0 0 currentColor;
    filter: blur(0);
  }
}

.entry-locked {
  animation: ink-bleed 0.5s ease-out;
}
```

---

## Portrait System

### SVG Structure

Villager portraits are simple, stylized SVGs that can be dynamically modified:

```svg
<svg viewBox="0 0 100 100" class="portrait">
  <!-- Face base -->
  <ellipse cx="50" cy="50" rx="35" ry="45" class="face"/>
  
  <!-- Eyes - modified based on trust -->
  <g class="eyes">
    <ellipse cx="35" cy="45" rx="5" ry="3" class="eye left"/>
    <ellipse cx="65" cy="45" rx="5" ry="3" class="eye right"/>
  </g>
  
  <!-- Mouth - modified based on wellbeing -->
  <path class="mouth" d="M 35 65 Q 50 70 65 65"/>
  
  <!-- Additional features per character -->
  <g class="features">
    <!-- Marta: aged lines -->
    <!-- Péter: strong jaw -->
    <!-- etc. -->
  </g>
</svg>
```

### Dynamic Modification

```javascript
function updatePortrait(villagerId, stats) {
  const portrait = document.querySelector(`#portrait-${villagerId}`);
  
  // Trust affects eyes
  const eyes = portrait.querySelector('.eyes');
  if (stats.trust < 30) {
    eyes.classList.add('suspicious');
  } else if (stats.trust > 70) {
    eyes.classList.add('warm');
  }
  
  // Wellbeing affects mouth
  const mouth = portrait.querySelector('.mouth');
  if (stats.wellbeing < 30) {
    mouth.setAttribute('d', 'M 35 70 Q 50 65 65 70'); // Frown
  } else if (stats.wellbeing > 70) {
    mouth.setAttribute('d', 'M 35 65 Q 50 75 65 65'); // Smile
  }
}
```

---

## Performance Considerations

### Animation Throttling

```javascript
// Reduce animations when not focused
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    document.body.classList.add('reduced-motion');
  } else {
    document.body.classList.remove('reduced-motion');
  }
});
```

```css
.reduced-motion * {
  animation-play-state: paused !important;
  transition: none !important;
}
```

### Audio Context Management

```javascript
// Resume audio context on user interaction
document.addEventListener('click', () => {
  if (AudioEngine.ctx.state === 'suspended') {
    AudioEngine.ctx.resume();
  }
}, { once: true });

// Suspend when tab is hidden
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    AudioEngine.ctx.suspend();
  } else {
    AudioEngine.ctx.resume();
  }
});
```

---

# PART VI: ENDINGS

## Ending Categories

### By Village State

**COLLAPSE**
- Tension exceeds 80 at end of Week 5
- Tomás has left or been driven out
- Multiple relationships destroyed
- Final image: The lighthouse beam over empty docks

**FRACTURE**
- Tension 50-80
- Village survives but divided
- Some relationships intact, others broken
- Final image: The lighthouse beam over a village with dark windows

**ENDURANCE**
- Tension 30-50
- Village continues, neither thriving nor dying
- Wounds covered but not healed
- Final image: The lighthouse beam over a quiet village

**PEACE**
- Tension below 30
- Major conflicts resolved or avoided
- Relationships mostly intact
- Final image: The lighthouse beam over a village with warm lights

### By Keeper State

**THE HONEST KEEPER**
- Wrote hard truths even when costly
- High truth count
- May have damaged relationships but maintained integrity
- Béla respects you

**THE MERCIFUL KEEPER**
- Protected people at the cost of truth
- High mercy count
- Relationships intact but secrets buried deeper
- Béla questions you — kindly

**THE CORRUPT KEEPER**
- Served self-interest
- High self-serving count
- Used the pen for personal safety or gain
- Béla condemns you

**THE INCONSISTENT KEEPER**
- No clear pattern
- Mixed counts
- Neither trusted nor condemned
- Béla is confused by you

### By Secret State

**THE TRUTH REVEALED**
- You exposed the twenty-year-old murder
- The village knows
- Péter knows about his father
- Consequences ripple into the future

**THE TRUTH BURIED**
- You kept the secret
- Marta is grateful
- The past stays past
- But you carry it now too

### By Signature

**SIGNED**
- You owned your record
- Your name goes to the mainland
- You are the Keeper, named and known

**UNSIGNED**
- You remained anonymous
- The record exists without attribution
- You could walk away and no one would know

## Ending Combinations

The final ending is a combination of these factors. Examples:

**PEACE + MERCIFUL + BURIED + SIGNED**
> "You kept the light burning and the village whole. You protected them from truths that would have destroyed them. Your name is on a record full of kind omissions. You can live with that. Most nights."

**FRACTURE + HONEST + REVEALED + UNSIGNED**
> "You wrote what was true. The village cracked under the weight of it. They'll rebuild, or they won't. You didn't sign your name — perhaps because you knew what it would mean to own this. Perhaps because you wanted to be able to walk away. You're still here, though. The light still needs keeping."

**COLLAPSE + CORRUPT + BURIED + SIGNED**
> "The village is empty now. They left, or turned on each other, or simply gave up. You survived — you made sure of that. Your name is on a record that tells a story no one will read, about a place that no longer exists. The lighthouse still turns. The light still burns. For who? For what? You're not sure anymore."

---

# PART VII: DEVELOPMENT NOTES

## Build Priority

### Phase 1: Core Loop
1. Basic state management
2. Event display and investigation
3. Fragment system (drag and drop)
4. Entry composition and preview
5. Week progression

### Phase 2: Narrative Content
1. All villager data
2. All week events with branching
3. All dialogue variations
4. Memory system
5. Béla's adaptive final conversation

### Phase 3: Consequence System
1. Immediate effects
2. Story flag tracking
3. Dialogue adaptation
4. Ending calculations

### Phase 4: Audio
1. Ambient layers
2. Tension system
3. UI sounds
4. Memory trigger sounds

### Phase 5: Visual Polish
1. Lighthouse beam
2. Sea animation
3. Tension vignette
4. Portrait system
5. Rain (Week 4)
6. Ink effects

### Phase 6: Accessibility & Polish
1. Keyboard navigation
2. Screen reader support
3. Performance optimization
4. Mobile responsiveness

## Testing Priorities

1. **Complete playthrough with all branches** - Can you reach every ending?
2. **State consistency** - Do story flags persist correctly?
3. **Consequence accuracy** - Do entries produce expected effects?
4. **Dialogue adaptation** - Does dialogue change based on prior choices?
5. **Audio in all browsers** - Does Web Audio work consistently?
6. **Performance** - Does it run smoothly on modest hardware?

---

# APPENDICES

## Appendix A: Complete Fragment Database

[To be populated during development — every fragment with its ID, text, type, and effects]

## Appendix B: Dialogue Scripts

[To be populated during development — every line of dialogue, organized by character and context]

## Appendix C: Sound Design Notes

[To be populated during development — specific frequencies, timings, and audio implementation details]

## Appendix D: Art Direction Reference

[Visual references, color studies, typography samples]

---

*This document is the creative bible for The Lighthouse Keeper. It should be updated as development proceeds. All creative decisions should be traceable to principles established here.*

*The goal is not to make a game. The goal is to make someone feel the weight of the pen.*
